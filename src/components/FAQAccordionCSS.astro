---
/**
 * FAQAccordionCSS.astro
 * FAQ Accordion usando apenas CSS (sem JavaScript/React)
 * Usa elemento <details> nativo para acessibilidade
 */

interface FAQ {
  id: string;
  question: string;
  answer: string;
  order?: number;
}

interface Props {
  faqs: FAQ[];
}

const { faqs } = Astro.props;

// Ordenar por order se disponivel
const sortedFaqs = [...faqs].sort((a, b) => (a.order ?? 0) - (b.order ?? 0));

// Gerar Schema FAQ
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": sortedFaqs.map(faq => ({
    "@type": "Question",
    "name": faq.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.answer
    }
  }))
};
---

<section class="my-12 faq-section">
  <!-- Schema.org FAQPage -->
  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

  <h2 class="text-2xl font-bold text-secondary-500 mb-6">
    Perguntas Frequentes
  </h2>

  <div class="space-y-3">
    {sortedFaqs.map((faq) => (
      <details
        class="faq-item group border border-secondary-200 rounded-xl overflow-hidden"
      >
        <summary class="faq-summary flex items-center justify-between p-5 cursor-pointer bg-white hover:bg-primary-50 transition-colors list-none">
          <span class="font-medium text-secondary-500 pr-4 group-hover:text-primary-600 transition-colors">
            {faq.question}
          </span>
          <span class="faq-icon flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full border-2 transition-all duration-300 border-secondary-300 text-secondary-400 group-hover:border-primary-500 group-hover:text-primary-500">
            <svg class="w-4 h-4 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
            </svg>
          </span>
        </summary>

        <div class="faq-content">
          <div class="p-5 pt-0 bg-white">
            <div class="pt-4 border-t border-secondary-100">
              <p class="faq-answer text-secondary-600 leading-relaxed">
                {faq.answer}
              </p>
            </div>
          </div>
        </div>
      </details>
    ))}
  </div>
</section>

<style>
  /* Remove default marker */
  .faq-summary::-webkit-details-marker,
  .faq-summary::marker {
    display: none;
  }

  /* Rotate icon when open */
  details[open] .faq-icon svg {
    transform: rotate(45deg);
  }

  /* Change icon style when open */
  details[open] .faq-icon {
    border-color: #FFD700;
    background-color: #FFD700;
    color: #1a1a2e;
  }

  /* Smooth content reveal */
  .faq-content {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.3s ease-out;
  }

  details[open] .faq-content {
    grid-template-rows: 1fr;
  }

  .faq-content > div {
    overflow: hidden;
  }
</style>
